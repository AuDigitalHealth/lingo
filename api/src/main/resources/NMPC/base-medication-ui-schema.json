{
  "ui:grid": [
    { "containedProducts": 24 },

    {
      "nonDefiningProperties": 24
    }
  ],
  "containedProducts": {
    "ui:options": {
      "arrayTemplate": "accordion",
      "skipTitle": true,
      "searchAndAddProduct": {
        "ecl": "(<763158003 minus >(<763158003))",
        "type": "medication",
        "package": false
      }
    },
    "items": {
      "ui:grid": [{ "productDetails": 24 }, { "value": 6, "unit": 6 }],
      "ui:options": {
        "titleSource": "productDetails.productName.pt.term",
        "defaultTitle": "Product",
        "skipTitle": true,
        "validateHiddenFields": false
      },
      "value": {
        "ui:widget": "text",
        "ui:options": {
          "inputType": "number",
          "title": "Pack Size",
          "placeholder": "Enter pack size"
        }
      },
      "unit": {
        "ui:field": "AutoCompleteField",
        "ui:title": "Unit",
        "ui:options": {
          "ecl": "((<781405001 minus >(<781405001)) : (774160008 /* OR 999000081000168101 */) = *).774163005",
          "showDefaultOptions": true,
          "placeholder": "Select unit (e.g., Each)"
        }
      },
      "productDetails": {
        "ui:options": {
          "skipTitle": true,
          "validateHiddenFields": false
        },
        "type": { "ui:widget": "hidden" },
        "ui:grid": [
           {"discriminator": 12, "productType": 12},
          {
            "productName": 12,
            "genericForm": 12
          },
          { "activeIngredients": 12, "_columnB": 12 }
        ],
        "_columnB": {
          "ui:grid": [
            { "specificForm": 24 },
            { "unitOfPresentation": 24 },
            { "targetPopulation": 24 },
            { "ingredientQualitativeStrength": 24 },
            {
              "nonDefiningProperties": 24
            }
          ]
        },
        "productType": {
          "ui:widget": "hidden"
        },
        "productName": {
          "ui:field": "AutoCompleteField",
          "ui:title": "Brand Name",
          "ui:options": {
            "ecl": "<774167006",
            "showDefaultOptions": false,
            "createBrand": {
              "ecl": "<774167006",
              "semanticTags": "(product name)"
            },
            "placeholder": "Enter brand name"
          }
        },
        "genericForm": {
          "ui:field": "AutoCompleteField",
          "ui:title": "Generic Dose Form",
          "ui:options": {
            "dependants": [
              {
                "path": "../specificForm",
                "ui:options": {
                  "getEcl": "<@parent",
                  "showDefaultOptions": true
                }
              }
            ],
            "ecl": "(>>((<763158003 minus >(<763158003)))).411116001",
            "extendedEcl": "<736542009",
            "showDefaultOptions": false,
            "placeholder": "Select generic dose form"
          }
        },
        "specificForm": {
          "ui:field": "AutoCompleteField",
          "ui:title": "Specific Dose Form",
          "ui:options": {
            "showDefaultOptions": true,
            "placeholder": "Select specific dose form (optional)"
          }
        },
        "unitOfPresentation": {
          "ui:field": "AutoCompleteField",
          "ui:title": "Unit of Presentation",
          "ui:options": {
            "ecl": "((<763158003 minus >(<763158003))).763032000",
            "extendedEcl": "<105590001",
            "showDefaultOptions": false,
            "placeholder": "Select unit of presentation"
          }
        },
        "targetPopulation": {
          "ui:field": "AutoCompleteField",
          "ui:title": "Target Population",
          "ui:options": {
            "ecl": "<27821000087106",
            "showDefaultOptions": true,
            "placeholder": "Select target population (optional)"
          }
        },
        "ingredientQualitativeStrength": {
          "ui:field": "AutoCompleteField",
          "ui:title": "Qualitative Strength",
          "ui:options": {
            "ecl": "<1149484003",
            "showDefaultOptions": true,
            "placeholder": "Select qualitative strength (optional)"
          }
        },
        "activeIngredients": {
          "ui:options": {
            "skipTitle": true,
            "arrayTemplate": "accordion"
          },
          "items": {
            "ui:options": {
              "titleSource": "activeIngredient.pt.term",
              "defaultTitle": "Ingredient",
              "skipTitle": true
            },
            "ui:grid": [
              { "activeIngredient": 24 },
              { "refinedActiveIngredient": 24 },
              { "preciseIngredient": 24 },
              { "basisOfStrengthSubstance": 24 },
              { "presentationStrengthNumerator": 24 },
              { "presentationStrengthDenominator": 24 },
              { "concentrationStrengthNumerator": 24 },
              { "concentrationStrengthDenominator": 24 }
            ],
            "activeIngredient": {
              "ui:field": "AutoCompleteField",
              "ui:title": "VTM Active Ingredient",
              "ui:options": {
                "dependants": [
                  {
                    "path": "../refinedActiveIngredient",
                    "ui:options": {
                      "getEcl": "<<@parent OR (<410942007:738774007=@parent) OR (<410942007:738774007=(<410942007:738774007=@parent))",
                      "showDefaultOptions": true
                    }
                  },
                  {
                    "path": "../basisOfStrengthSubstance",
                    "ui:options": {
                      "getEcl": "<<@parent OR (<410942007:738774007=@parent) OR (<410942007:738774007=(<410942007:738774007=@parent))",
                      "getExtendedEcl": "<105590001",
                      "showDefaultOptions": true
                    }
                  }
                ],
                "ecl": "(<763158003 {{ D term=\"medicinal product\" }}).127489000",
                "extendedEcl": "<105590001",
                "showDefaultOptions": false,
                "placeholder": "Select VTM active ingredient"
              }
            },
            "refinedActiveIngredient": {
              "ui:field": "AutoCompleteField",
              "ui:title": "VMP Active Ingredient",
              "ui:options": {
                "dependants": [
                  {
                    "path": "../preciseIngredient",
                    "ui:options": {
                      "getEcl": "<<@parent OR (<410942007:738774007=@parent) OR (<410942007:738774007=(<410942007:738774007=@parent))",
                      "showDefaultOptions": true
                    }
                  }
                ],
                "placeholder": "Select VMP active ingredient"
              }
            },
            "preciseIngredient": {
              "ui:field": "AutoCompleteField",
              "ui:title": "AMP Active Ingredient",
              "ui:options": {
                "showDefaultOptions": true,
                "placeholder": "Select AMP active ingredient"
              }
            },
            "basisOfStrengthSubstance": {
              "ui:field": "AutoCompleteField",
              "ui:title": "Basis of Strength Substance",
              "ui:options": {
                "showDefaultOptions": false,
                "placeholder": "Select basis of strength",
                "description": "Only enabled if Active Ingredient is set."
              }
            },
            "presentationStrengthNumerator": {
              "ui:options": { "skipTitle": true },
              "ui:grid": [{ "value": 12, "unit": 12 }],
              "value": {
                "ui:widget": "text",
                "ui:title": "Presentation Strength Numerator",
                "ui:options": {
                  "inputType": "number",
                  "placeholder": "Enter value"
                }
              },
              "unit": {
                "ui:field": "AutoCompleteField",
                "ui:title": "Unit",
                "ui:options": {
                  "ecl": "((<763158003 minus >(<763158003))).732945000",
                  "extendedEcl": "<767524001",
                  "showDefaultOptions": true,
                  "placeholder": "Select unit"
                }
              }
            },
            "presentationStrengthDenominator": {
              "ui:options": { "skipTitle": true },
              "ui:grid": [{ "value": 12, "unit": 12 }],
              "value": {
                "ui:widget": "text",
                "ui:title": "Presentation Strength Denominator",
                "ui:options": {
                  "inputType": "number",
                  "placeholder": "Enter value"
                }
              },
              "unit": {
                "ui:field": "AutoCompleteField",
                "ui:title": "Unit",
                "ui:options": {
                  "ecl": "((<763158003 minus >(<763158003))).732947008",
                  "extendedEcl": "<767524001",
                  "showDefaultOptions": true,
                  "placeholder": "Select unit"
                }
              }
            },
            "concentrationStrengthNumerator": {
              "ui:options": { "skipTitle": true },
              "ui:grid": [{ "value": 12, "unit": 12 }],
              "value": {
                "ui:widget": "text",
                "ui:title": "Concentration Strength Numerator",
                "ui:options": {
                  "inputType": "number",
                  "placeholder": "Enter value"
                }
              },
              "unit": {
                "ui:field": "AutoCompleteField",
                "ui:title": "Unit",
                "ui:options": {
                  "ecl": "((<763158003 minus >(<763158003))).733725009",
                  "extendedEcl": "<767524001",
                  "showDefaultOptions": true,
                  "placeholder": "Select unit"
                }
              }
            },
            "concentrationStrengthDenominator": {
              "ui:options": { "skipTitle": true },
              "ui:grid": [{ "value": 12, "unit": 12 }],
              "value": {
                "ui:widget": "text",
                "ui:title": "Concentration Strength Denominator",
                "ui:options": {
                  "inputType": "number",
                  "placeholder": "Enter value"
                }
              },
              "unit": {
                "ui:field": "AutoCompleteField",
                "ui:title": "Unit",
                "ui:options": {
                  "ecl": "((<763158003 minus >(<763158003))).733722007",
                  "extendedEcl": "<767524001",
                  "showDefaultOptions": true,
                  "placeholder": "Select unit"
                }
              }
            }
          }
        }
      }
    }
  }
}
